particlesJS.load("particles-js","assets/particlesjs-config.json",function(){console.log("callback - particles.js config loaded")});let user={},symbols=["🍬","🎃","🔔","🪦","🦇","🧛"],balance=1e4,paylines=[[0,0,0,0,0],[1,1,1,1,1],[2,2,2,2,2],[0,1,2,1,0],[2,1,0,1,2],[0,0,1,2,6],[2,2,1,0,0],[0,1,1,1,0],[2,1,1,1,2],[1,0,0,0,1],[1,2,2,2,1],[0,1,2,2,1],[2,1,0,0,1],[0,0,2,2,0],[2,2,0,0,2],[1,0,1,2,1],[1,2,1,0,1],[0,2,2,1,0],[2,0,0,1,2],[1,1,0,2,1],[2,0,1,0,2],[0,2,1,2,0],[1,1,2,0,1],[1,2,0,1,1],[2,1,2,1,0]];async function createUser(){var e=localStorage.getItem("user");e?(user=JSON.parse(e),balance=user.balance,document.querySelector("header .fullname").innerHTML=user.fullname,updateBalance(),console.log(user)):(e="User"+(new Date).getMilliseconds()+(new Date).getSeconds(),e=await(await fetch("http://localhost:4000/user/create_user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullname:e})})).json(),user=e.data,localStorage.setItem("user",JSON.stringify(user)),document.querySelector("header .fullname").innerHTML=user.fullname,console.log(e))}async function createAudit(e){e=await(await fetch("http://localhost:4000/user/create_audit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userID:user._id,info:e,balance:balance})})).json();console.log("res",e)}createUser(),document.querySelector(".welcome-container").addEventListener("click",function(){document.querySelector("#spookyAudio").play(),gsap.to(".welcome-container",{height:0,opacity:0,ease:"power4.inOut",onComplete:()=>{document.querySelector(".game-container").style.display="block",gsap.to(".game-container",{opacity:1,ease:"power4.inOut"})}})});let isSpinning=!1;function spinReels(){if(console.log("spinReeles"),gsap.to(".win-container",{height:0,opacity:1}),!isSpinning){isSpinning=!0,document.querySelectorAll(".reel div").forEach(e=>{e.style.backgroundColor="#444",e.style.animationPlayState="paused"});let t=parseInt(document.getElementById("bet").value),a=parseInt(document.getElementById("paylines").value);var e=t*a;if(e>balance)alert("Not enough balance!");else{balance-=e,createAudit(`You used ${t} Berperline and ${a} Payline.`),localStorage.setItem("user",JSON.stringify({...user,balance:balance})),updateBalance();let n=[...Array(5)].map(()=>[...Array(3)].map(()=>symbols[Math.floor(Math.random()*symbols.length)]));console.log(n),displayReels(n),gsap.from(".reel div",{duration:2,y:-200,onComplete:()=>{var e=checkWins(n,a,t);balance+=e,createAudit(`You won ${e}.`),localStorage.setItem("user",JSON.stringify({...user,balance:balance})),updateBalance(),console.log("Result: ",0<e?"Wins":"Lose"),isSpinning=!1}})}}}function displayReels(n){n.forEach((e,n)=>{let t=document.getElementById("reel"+(n+1));t.innerHTML="",e.forEach(e=>{var n=document.createElement("div");n.textContent=e,t.appendChild(n)})});for(let e=0;e<2;e++)n.forEach((e,n)=>{let t=document.getElementById("reel"+(n+1));e.forEach(e=>{var n=document.createElement("div");n.textContent=e,t.appendChild(n)})})}function checkWins(n,t,l){let o=0;for(let e=0;e<t;e++){let t=paylines[e],a=n[0][t[0]];console.log("firstSymbol",a),console.log("payline",t);var c=n.every((e,n)=>e[t[n]]===a);console.log("isWin",c),c&&(t.forEach((e,n)=>{document.querySelectorAll(`#reel${n+1} div`)[e].style.animationPlayState="running",gsap.to(".win-container",{height:"auto",opacity:1});n=document.getElementById("thunderAudio");n.currentTime=0,n.play()}),o+=5*l)}return o}function updateBalance(){document.getElementById("balance").innerHTML=balance+'<span class="balance-unit">Balance</span>'}document.getElementById("spin").addEventListener("click",spinReels);