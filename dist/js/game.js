let symbols=["🍬","🎃","🔔","🪦","🦇","🧛"],paylines=[[0,0,0,0,0],[1,1,1,1,1],[2,2,2,2,2],[0,1,2,1,0],[2,1,0,1,2],[0,0,1,2,6],[2,2,1,0,0],[0,1,1,1,0],[2,1,1,1,2],[1,0,0,0,1],[1,2,2,2,1],[0,1,2,2,1],[2,1,0,0,1],[0,0,2,2,0],[2,2,0,0,2],[1,0,1,2,1],[1,2,1,0,1],[0,2,2,1,0],[2,0,0,1,2],[1,1,0,2,1],[2,0,1,0,2],[0,2,1,2,0],[1,1,2,0,1],[1,2,0,1,1],[2,1,2,1,0]];async function createAudit(e){e=await(await fetch("http://localhost:4000/user/create_audit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userID:user._id,info:e,balance:balance})})).json();console.log("res",e)}document.querySelector(".no-balance-model-parent .overlay").addEventListener("click",function(){gsap.to(".no-balance-model-parent",{opacity:0,ease:"power4.inOut",onComplete:()=>{document.querySelector(".no-balance-model-parent").style.display="none"}})}),document.querySelector(".welcome-container").addEventListener("click",function(){document.querySelector("#spookyAudio").play(),gsap.to(".welcome-container",{height:0,opacity:0,ease:"power4.inOut",onComplete:()=>{document.querySelector(".game-container").style.display="block",gsap.to(".game-container",{opacity:1,ease:"power4.inOut"})}})});let isSpinning=!1;function spinReels(){if(console.log("spinReeles"),gsap.to(".win-container",{height:0,opacity:1}),!isSpinning){isSpinning=!0,document.querySelectorAll(".reel div").forEach(e=>{e.style.backgroundColor="#444",e.style.animationPlayState="paused"});let t=parseInt(document.getElementById("bet").value),o=parseInt(document.getElementById("paylines").value);var e=t*o;if(e>balance)document.querySelector(".no-balance-model-parent").style.display="block",gsap.to(".no-balance-model-parent",{opacity:1,ease:"power4.inOut",onComplete:()=>isSpinning=!1});else{balance-=e,createAudit(`You used ${t} Berperline and ${o} Payline.`),localStorage.setItem("user",JSON.stringify({...user,balance:balance})),updateBalance();let n=[...Array(5)].map(()=>[...Array(3)].map(()=>symbols[Math.floor(Math.random()*symbols.length)]));console.log(n),displayReels(n),gsap.from(".reel div",{duration:2,y:-200,onComplete:()=>{var e=checkWins(n,o,t);balance+=e,localStorage.setItem("user",JSON.stringify({...user,balance:balance})),updateBalance(),console.log("Result: ",0<e?"Wins":"Lose"),isSpinning=!1}})}}}function displayReels(n){n.forEach((e,n)=>{let t=document.getElementById("reel"+(n+1));t.innerHTML="",e.forEach(e=>{var n=document.createElement("div");n.textContent=e,t.appendChild(n)})});for(let e=0;e<2;e++)n.forEach((e,n)=>{let t=document.getElementById("reel"+(n+1));e.forEach(e=>{var n=document.createElement("div");n.textContent=e,t.appendChild(n)})})}function checkWins(n,t,a){let l=0;for(let e=0;e<t;e++){let t=paylines[e],o=n[0][t[0]];console.log("firstSymbol",o),console.log("payline",t);var i=n.every((e,n)=>e[t[n]]===o);console.log("isWin",i),i&&(t.forEach((e,n)=>{document.querySelectorAll(`#reel${n+1} div`)[e].style.animationPlayState="running",gsap.to(".win-container",{height:"auto",opacity:1});n=document.getElementById("thunderAudio");n.currentTime=0,n.play()}),createAudit(`You won ${l}.`),l+=5*a)}return l}document.getElementById("spin").addEventListener("click",spinReels);